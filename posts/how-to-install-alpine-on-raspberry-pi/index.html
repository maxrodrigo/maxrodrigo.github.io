<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta http-equiv=content-language content="en">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=color-scheme content="light dark">
<title>How to Install Alpine Linux on Raspberry Pi | Max Rodrigo </title>
<meta property="article:published_time" content="2021-10-05T00:00:00+00:00">
<meta name=robots content="index, follow">
<meta name=keywords content>
<meta name=description content="Preparation   Download the Raspberry Pi build.
Which version should I install?
TL;DR: Unless you are using Raspberry Pi 2 Model B or Raspberry Pi Zero, install aarch64.
There are currently three versions of Alpine for Raspberry Pi: armhf, armv7, and aarch64.
You should be safe using the armhf build on all versions including Pi Zero and Compute Modules, but it may perform less optimally on recent versions of Raspberry Pi.">
<meta name=author content="Max Rodrigo">
<link rel=canonical href=https://www.maxrodrigo.com/posts/how-to-install-alpine-on-raspberry-pi/>
<link rel=icon href=favicon.ico>
<link rel=stylesheet href=/scss/style.min.daf957888ffbc1042b0445afbb60013e76449126cf0e9b47e60c5ecdfd955020.css integrity="sha256-2vlXiI/7wQQrBEWvu2ABPnZEkSbPDptH5gxezf2VUCA=">
<meta itemprop=name content="How to Install Alpine Linux on Raspberry Pi">
<meta itemprop=description content="Preparation   Download the Raspberry Pi build.
Which version should I install?
TL;DR: Unless you are using Raspberry Pi 2 Model B or Raspberry Pi Zero, install aarch64.
There are currently three versions of Alpine for Raspberry Pi: armhf, armv7, and aarch64.
You should be safe using the armhf build on all versions including Pi Zero and Compute Modules, but it may perform less optimally on recent versions of Raspberry Pi."><meta itemprop=datePublished content="2021-10-05T00:00:00+00:00">
<meta itemprop=dateModified content="2022-01-29T20:42:00+00:00">
<meta itemprop=wordCount content="718">
<meta itemprop=keywords content><meta name=twitter:card content="summary">
<meta name=twitter:title content="How to Install Alpine Linux on Raspberry Pi">
<meta name=twitter:description content="Preparation   Download the Raspberry Pi build.
Which version should I install?
TL;DR: Unless you are using Raspberry Pi 2 Model B or Raspberry Pi Zero, install aarch64.
There are currently three versions of Alpine for Raspberry Pi: armhf, armv7, and aarch64.
You should be safe using the armhf build on all versions including Pi Zero and Compute Modules, but it may perform less optimally on recent versions of Raspberry Pi.">
<meta property="og:title" content="How to Install Alpine Linux on Raspberry Pi">
<meta property="og:description" content="Preparation   Download the Raspberry Pi build.
Which version should I install?
TL;DR: Unless you are using Raspberry Pi 2 Model B or Raspberry Pi Zero, install aarch64.
There are currently three versions of Alpine for Raspberry Pi: armhf, armv7, and aarch64.
You should be safe using the armhf build on all versions including Pi Zero and Compute Modules, but it may perform less optimally on recent versions of Raspberry Pi.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.maxrodrigo.com/posts/how-to-install-alpine-on-raspberry-pi/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-10-05T00:00:00+00:00">
<meta property="article:modified_time" content="2022-01-29T20:42:00+00:00">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D07XMVNLNT"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-D07XMVNLNT',{anonymize_ip:!1})}</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-D07XMVNLNT','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<meta name=generator content="Hugo 0.92.1">
</head>
<body>
<header role=main>
<h1>Max Rodrigo</h1>
<nav>
<ul>
<li><a href=/>~/</a></li>
<li><a href=/posts/>posts</a></li>
</ul>
</nav>
</header>
<main>
<article>
<div class=post-meta>
<ul>
<li>
<time datetime=2021-10-05T00:00:00>5 Oct 2021</time>
</li>
</ul>
</div>
<h1>How to Install Alpine Linux on Raspberry Pi</h1>
<div>
<h2 id=preparation>Preparation</h2>
<ol>
<li>
<p><a href=https://alpinelinux.org/downloads/>Download</a> the Raspberry Pi build.</p>
<p><strong>Which version should I install?</strong></p>
<p><strong>TL;DR: Unless you are using Raspberry Pi 2 Model B or Raspberry Pi Zero, install</strong> <code>aarch64</code>.</p>
<p>There are currently three versions of Alpine for Raspberry Pi: <code>armhf</code>, <code>armv7</code>, and <code>aarch64</code>.</p>
<p>You should be safe using the <code>armhf</code> build on all versions including Pi Zero and Compute Modules, but it may perform less optimally on recent versions of Raspberry Pi.</p>
<p>The <code>armv7</code> build is compatible with the Raspberry Pi 2 Model B. The <code>aarch64</code> build should be compatible with Raspberry Pi 2 Model v1.2, Raspberry Pi 3 and Compute Module 3, and Raspberry Pi 4 Model B.</p>
</li>
<li>
<p>Identify <strong>your</strong> memory card name: <code>lsblk</code>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>$ lsblk
NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT
mmcblk0     179:0    <span style=color:#ae81ff>0</span>  59.5G  <span style=color:#ae81ff>0</span> disk
├─mmcblk0p1 179:1    <span style=color:#ae81ff>0</span>   174K  <span style=color:#ae81ff>0</span> part
├─mmcblk0p2 179:2    <span style=color:#ae81ff>0</span>   1.4M  <span style=color:#ae81ff>0</span> part
└─mmcblk0p3 179:3    <span style=color:#ae81ff>0</span> 130.7M  <span style=color:#ae81ff>0</span> part
</code></pre></div></li>
<li>
<p>Partition and format the memory card.</p>
<p>Install <a href=https://www.gnu.org/software/parted/>GNU Parted</a> (<code>parted</code>) and <a href=https://linux.die.net/man/8/mkfs.vfat>mkfs.vfat</a> (<code>dosfstools</code>) if not available.</p>
<p>Create a small partition for <code>/boot</code>, then allocate the rest of the disk to a separate partition.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo parted /dev/mmcblk0 --script -- mklabel msdos
sudo parted /dev/mmcblk0 --script -- mkpart primary fat32 <span style=color:#ae81ff>1</span> 256M
sudo parted /dev/mmcblk0 --script -- mkpart primary ext4 256M 100%
</code></pre></div><p>Set the boot partition <a href=https://www.gnu.org/software/parted/manual/html_node/set.html>flags</a> and format.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo parted /dev/mmcblk0 --script -- set <span style=color:#ae81ff>1</span> boot on
sudo parted /dev/mmcblk0 --script -- set <span style=color:#ae81ff>1</span> lba on

sudo mkfs.fat -F32 -I /dev/mmcblk0p1
sudo mkfs.ext4 /dev/mmcblk0p2
</code></pre></div><p>You can verify by printing the partition table.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo parted /dev/mmcblk0 --script print
</code></pre></div></li>
<li>
<p>Mount the boot partition.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo mount /dev/mmcblk0p1 /mnt/sd
</code></pre></div></li>
<li>
<p>Unpack the Alpine package onto the partition.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo tar xf alpine-rpi-**.tar.gz -C /mnt/sd --no-same-owner
</code></pre></div></li>
<li>
<p>Create the <code>usercfg.txt</code> file into the boot partition: <code>/mnt/sd/usercfg.txt</code>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt># Enable mini UART as serial port (/dev/ttyS0).
# Also, fixes VideoCore IV (aka the GPU or the VPU) frequency to 250MHz.
enable_uart=1

# give the GPU the least amount of RAM it can get by with (16MB).
# This also triggers the Pi to use a cutdown version of the firmware (start_cd.elf).
gpu_mem=16

# Optionally turn off audio and bluetooth.  (Note &#34;dt&#34; stands for device tree)
dtparam=audio=off,pi3-disable-bt
</code></pre></div></li>
<li>
<p>Headless Installation (<em>optional</em>)</p>
<p>If you don&rsquo;t have direct access to your system, such as via a display and keyboard you can install Alpine with the overlay directory structure and headless script.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>curl -o headless.apkovl.tar.gz https://github.com/davidmytton/alpine-linux-headless-raspberrypi/releases/download/2021.06.23/headless.apkovl.tar.gz
sudo cp headless.apkovl.tar.gz /mnt/sd/
</code></pre></div></li>
<li>
<p>Copy an answer file (<em>optional</em>).</p>
<p>During the setup process
an <em><a href=https://docs.alpinelinux.org/user-handbook/0.1a/Installing/setup_alpine.html#_answer_files>answer file</a></em> can be provided
to automate the configuration process.</p>
</li>
<li>
<p>Unmount.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo umount /mnt/sd
</code></pre></div></li>
</ol>
<h2 id=alpine-installation>Alpine Installation</h2>
<ol>
<li>
<p>Log in into Alpine with the default username and password. If you have a headless installation you can ssh into the Raspberry Pi.</p>
<p>Default Alpine login credentials are username <code>root</code> with <strong>empty password</strong>.</p>
</li>
<li>
<p>Run setup.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>setup-alpine
</code></pre></div><p>Alternatively to the interactive mode,
an answer file can be provided to automate the configuration process.
See preparation.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>setup-alpine -f /media/mmcblk0p1/alpine-setup.txt
</code></pre></div></li>
<li>
<p>Create system partitions.</p>
<p>Resize the FAT32 partition to 1GB and use the remaining space to create a new primary bootable partition where Alpine Linux is gonna being installed.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>apk add e2fsprogs
mkfs.ext4 /dev/mmcblk0p2
mount /dev/mmcblk0p2 /mnt
</code></pre></div></li>
<li>
<p>Install the system files.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>setup-disk -m sys /mnt
</code></pre></div><p>If you get <code>ext4 is not supported . Only supported are: vfat</code> error, run with <code>FORCE_BOOTFS</code> set.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>FORCE_BOOTFS<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> setup-disk -m sys /mnt
</code></pre></div></li>
<li>
<p>Remount old partition in RW. An update in the first partition is required for the next reboot.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>mount -o remount,rw /media/mmcblk0p1
</code></pre></div></li>
<li>
<p>Clean up the boot folder in the first partition to drop unused files.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>rm -f /media/mmcblk0p1/boot/*
cd /mnt
rm boot/boot
</code></pre></div></li>
<li>
<p>Move the image and <code>init ram</code> for Alpine Linux into the right place.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>mv boot/* /media/mmcblk0p1/boot
rm -Rf boot
mkdir media/mmcblk0p1 <span style=color:#75715e># It&#39;s the mount point for the first partition on the next reboot</span>
</code></pre></div></li>
<li>
<p>Update <code>/etc/fstab</code>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>echo <span style=color:#e6db74>&#34;/dev/mmcblk0p1 /media/mmcblk0p1 vfat defaults 0 0&#34;</span> &gt;&gt; etc/fstab
sed -i <span style=color:#e6db74>&#39;/cdrom/d&#39;</span> etc/fstab
sed -i <span style=color:#e6db74>&#39;/floppy/d&#39;</span> etc/fstab
</code></pre></div></li>
<li>
<p>Enable edge repository.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sed -i <span style=color:#e6db74>&#39;/edge/s/^#//&#39;</span> /mnt/etc/apk/repositories
</code></pre></div></li>
<li>
<p>For the next boot, indicate that the root filesystem is on the second partition. If the cmdline.txt file contains a line that starts with /root, then use sed:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sed -i <span style=color:#e6db74>&#39;s/$/ root=\/dev\/mmcblk0p2 /&#39;</span> /media/mmcblk0p1/cmdline.txt
</code></pre></div></li>
<li>
<p>Make sure that appropriate <code>cgroups</code> are enabled</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sed -i <span style=color:#e6db74>&#34;s/</span>$<span style=color:#e6db74>/ cgroup_enable=cpuset cgroup_enable=memory cgroup_memory=1/&#34;</span> /media/mmcblk0p1/cmdline.txt
</code></pre></div></li>
<li>
<p>If using <code>chrony</code>, allow the system clock to be stepped in the first three updates if its offset is larget than 1 second.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>echo <span style=color:#e6db74>&#34;makestep 1.0 3&#34;</span> &gt;&gt; /etc/chrony/chrony.conf
</code></pre></div></li>
<li>
<p>Reboot</p>
</li>
</ol>
</div>
</article>
</main>
<footer>
<span>&copy; 2022 <a href=https://www.maxrodrigo.com/>Max Rodrigo</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
      <a href=https://github.com/maxrodrigo/hugo-theme-wisdom/ rel=noopener target=_blank>Wisdom</a>
</span>
</footer>
</body>
</html>